{
  "filename": "upgrade.md",
  "__html": "<h1>DolphinScheduler Upgrade Documentation</h1>\n<h2>Back-Up Previous Version's Files and Database</h2>\n<h2>Stop All Services of DolphinScheduler</h2>\n<p><code>sh ./script/stop-all.sh</code></p>\n<h2>Download the Latest Version Installation Package</h2>\n<ul>\n<li><a href=\"/en-us/download/download.html\">download</a> the latest version of the installation packages.</li>\n<li>The following upgrade operations need to be performed in the new version's directory.</li>\n</ul>\n<h2>Database Upgrade</h2>\n<ul>\n<li>\n<p>If using MySQL as the database to run DolphinScheduler, please config it in <code>./bin/env/dolphinscheduler_env.sh</code>, change username and password to yours, and add MYSQL connector jar into lib dir <code>./tools/libs</code>, here we download <code>mysql-connector-java-8.0.16.jar</code>, and then correctly configure database connection information. You can download MYSQL connector jar from <a href=\"https://downloads.MySQL.com/archives/c-j/\">here</a>. Otherwise, PostgreSQL is the default database.</p>\n<pre><code class=\"language-shell\">export DATABASE=${DATABASE:-mysql}\nexport SPRING_PROFILES_ACTIVE=${DATABASE}\nexport SPRING_DATASOURCE_DRIVER_CLASS_NAME=com.mysql.cj.jdbc.Driver\nexport SPRING_DATASOURCE_URL=jdbc:mysql://127.0.0.1:3306/dolphinscheduler?useUnicode=true&amp;characterEncoding=UTF-8\nexport SPRING_DATASOURCE_USERNAME={user}\nexport SPRING_DATASOURCE_PASSWORD={password}\n</code></pre>\n</li>\n<li>\n<p>Execute database upgrade script:</p>\n<p><code>sh ./tools/bin/upgrade-schema.sh</code></p>\n</li>\n</ul>\n<h2>Backend Service Upgrade</h2>\n<h3>Modify the Content in <code>conf/config/install_config.conf</code> File</h3>\n<ul>\n<li>Standalone Deployment please refer to the <a href=\"./installation/standalone.md\">Standalone-Deployment</a>.</li>\n<li>Cluster Deployment please refer to the <a href=\"./installation/cluster.md\">Cluster-Deployment</a>.</li>\n</ul>\n<h4>Masters Need Attentions</h4>\n<p>Create worker group in 1.3.1 version has a different design:</p>\n<ul>\n<li>Before version 1.3.1 worker group can be created through UI interface.</li>\n<li>Since version 1.3.1 worker group can be created by modifying the worker configuration.</li>\n</ul>\n<h4>When Upgrade from Version Before 1.3.1 to 1.3.2, the Below Operations are What We Need to Do to Keep Worker Group Configuration Consist with Previous</h4>\n<ol>\n<li>Go to the backup database, search records in <code>t_ds_worker_group table</code>, mainly focus <code>id, name and IP</code> three columns.</li>\n</ol>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">id</th>\n<th style=\"text-align:center\">name</th>\n<th style=\"text-align:right\">ip_list</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">1</td>\n<td style=\"text-align:center\">service1</td>\n<td style=\"text-align:right\">192.168.xx.10</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">2</td>\n<td style=\"text-align:center\">service2</td>\n<td style=\"text-align:right\">192.168.xx.11,192.168.xx.12</td>\n</tr>\n</tbody>\n</table>\n<ol start=\"2\">\n<li>Modify the worker configuration in <code>conf/config/install_config.conf</code> file.</li>\n</ol>\n<p>Assume bellow are the machine worker service to be deployed:</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">hostname</th>\n<th style=\"text-align:center\">ip</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">ds1</td>\n<td style=\"text-align:center\">192.168.xx.10</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">ds2</td>\n<td style=\"text-align:center\">192.168.xx.11</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">ds3</td>\n<td style=\"text-align:center\">192.168.xx.12</td>\n</tr>\n</tbody>\n</table>\n<p>To keep worker group config consistent with the previous version, we need to modify workers configuration as below:</p>\n<pre><code class=\"language-shell\"><span class=\"hljs-meta\">#</span><span class=\"bash\">worker service is deployed on <span class=\"hljs-built_in\">which</span> machine, and also specify <span class=\"hljs-built_in\">which</span> worker group this worker belongs to.</span> \nworkers=&quot;ds1:service1,ds2:service2,ds3:service2&quot;\n</code></pre>\n<h4>The Worker Group has Been Enhanced in Version 1.3.2</h4>\n<p>Workers in 1.3.1 can't belong to more than one worker group, but in 1.3.2 it's supported. So in 1.3.1 it's not supported when <code>workers=&quot;ds1:service1,ds1:service2&quot;</code>, and in 1.3.2 it's supported.</p>\n<h3>Execute Deploy Script</h3>\n<pre><code class=\"language-shell\">`sh install.sh`\n</code></pre>\n",
  "link": "/dist/en-us/docs/dev/user_doc/guide/upgrade.html",
  "meta": {}
}